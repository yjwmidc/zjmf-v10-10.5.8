<link rel="stylesheet" href="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/css/cloud_detail.css">

<div id="template2" v-cloak class="product-detail-page">
  <top-menu neednav>
    <template #left>
      <van-icon @click="goBack" class="left-icon" name="arrow-left"></van-icon>
    </template>
    <template #center>
      <div class="nav-title">{{lang.common_cloud_text43}}</div>
    </template>
  </top-menu>
  <div class="page-content">
    <div class="info-box">
      <div class="info-top">
        <div class="info-name">{{hostData.product_name}}
          <img v-if="powerStatusArr[status]?.icon" :src="powerStatusArr[status]?.icon" alt=""
            :title="powerStatusArr[status]?.text" class="prow-img">
        </div>
        <p class="host-status" @click="goPay" :class="hostData.status">{{hostData.status_name}}</p>
      </div>
      <div class="info-bottom">
        <span class="name">{{hostData.name}}</span>
        <van-divider vertical></van-divider>
        <span class="ip">{{cloudData.ip}}</span>
      </div>
      <div class="info-notes">
        <!-- 有备注 -->
        <span class="yes-notes" v-if="hostData.notes" @click="doEditNotes">
          <van-icon name="edit"></van-icon>
          <span class="notes-text">{{hostData.notes}}</span>
        </span>
        <!-- 无备注 -->
        <span class="no-notes" v-else @click="doEditNotes">
          {{lang.cloud_add_notes + ' +'}}
        </span>
      </div>
    </div>
    <div class="op-box" v-if="hostData.status == 'Active' && !initLoading">
      <div class="op-item" @click="doGetVncUrl">
        <div class="op-icon">
          <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/console.svg"
            alt="">
        </div>
        <div class="op-name">
          {{lang.common_cloud_btn11}}
        </div>
      </div>
      <div class="op-item">
        <van-popover>
          <template #reference>
            <div class="op-icon">
              <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/prower.svg"
                alt="">
            </div>
            <div class="op-name">
              {{lang.porwer_text1}}
            </div>
          </template>
          <div class="sure-remind">
            <van-button type="primary" class="opt-item" v-for="item in powerList" :key="item.id"
              @click="showPowerDialog(item.value)">
              {{item.label}}
            </van-button>
          </div>
        </van-popover>
      </div>
      <div class="op-item">
        <van-popover>
          <template #reference>
            <div class="op-icon">
              <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/restart.svg"
                alt="">
            </div>
            <div class="op-name">
              {{ status === 'operating' ? powerStatusArr[status].text : lang.common_cloud_text13 }}
            </div>
          </template>
          <div class="sure-remind">
            <van-button type="primary" class="opt-item" v-for="item in restartList" :key="item.id"
              @click="showPowerDialog(item.value)">
              {{item.label}}
            </van-button>
          </div>
        </van-popover>
      </div>
      <div class="op-item" v-if="isRefundPlugin">
        <template
          v-if="refundData && (refundData.status=='Pending' || refundData.status=='Suspend' || refundData.status=='Suspending')">
          <div class="op-icon" @click="quitRefund">
            <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/reset.svg"
              alt="">
          </div>
          <div class="op-name" @click="quitRefund">
            <div class="refund-status"
              v-if="refundData && refundData.status != 'Cancelled' && refundData.status != 'Reject'">
              {{refundStatus[refundData.status]}}
            </div>
            {{lang.common_cloud_btn8}}
          </div>
        </template>
        <template
          v-if="!refundData || (refundData && (refundData.status=='Reject')) || (refundData && (refundData.status=='Cancelled'))">
          <div class="op-icon" @click="showRefund">
            <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/reset.svg"
              alt="">
          </div>
          <div @click="showRefund" class="op-name">
            <div class="refund-status"
              v-if="refundData && refundData.status != 'Cancelled' && refundData.status != 'Reject'">
              {{refundStatus[refundData.status]}}
            </div>
            {{lang.common_cloud_btn9}}
          </div>
        </template>
      </div>
    </div>
  </div>

  <van-tabs v-model:active="activeName" @change="handleClick" class="tab-box" line-width="16px"
    title-active-color="var(--van-primary-color)">
    <van-tab :title="lang.summarize" name="summarize">
      <div class="page-main summarize">
        <div class="pro-detail">
          <div class="info-title">
            <span>{{lang.appstore_text301}}</span>
          </div>
          <div class="info-item" v-for="(item,index) in configDetails">
            <p class="label">{{item.name}}:</p>
            <p class="value">
              <span>{{item.sub_name || '--'}}</span>
            </p>
          </div>
          <template v-if="cloudData.host_data">
            <div class="info-item">
              <p class="label">{{lang.common_cloud_label14}}:</p>
              <p class="value">
                <span>{{cloudData.host_data.username}}</span>
              </p>
            </div>
            <div class="info-item">
              <p class="label">{{lang.common_cloud_label13}}:</p>
              <p class="value">
                <span>{{cloudData.host_data.port}}</span>
              </p>
            </div>
            <div class="info-item">
              <p class="label">{{lang.login_pass}}:</p>
              <p class="value">
                <span v-show="isShowPass"> {{cloudData.host_data.password}} </span>
                <span v-show="!isShowPass"> {{calcPassword(cloudData.host_data.password)}} </span>
                <img class="eyes" @click="isShowPass=!isShowPass"
                  :src="isShowPass ? '/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloud/pass-show.png':'/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloud/pass-hide.png'" />
                <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/copy.svg"
                  class="copy-btn" v-copy="cloudData.host_data.password" alt="">
              </p>
            </div>
          </template>
          <div class="info-item" v-for="(item,index) in self_defined_field" :key="item.id + 'hhh'">
            <p class="label">{{item.field_name}}:</p>
            <p class="value">
              <span v-if="item.field_type === 'password'">
                <span v-if="!item.hidenPass && item.value">{{item.value.replace(/./g, '*')}}</span>
                <span v-else>{{item.value || '--'}}</span>
              </span>
              <span v-else-if="item.field_type === 'textarea'" class="word-pre">{{item.value || '--'}}</span>
              <span v-else>{{item.value || '--'}}</span>
              <img class="eyes" @click="item.hidenPass =!item.hidenPass"
                v-if="item.field_type === 'password' && item.value"
                :src="item.hidenPass ? '/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloud/pass-show.png':'/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloud/pass-hide.png'" />
              <img v-if="(item.field_type === 'password' || item.field_type === 'link') && item.value"
                src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/copy.svg" class="copy-btn"
                v-copy="item.value" alt="">
            </p>
          </div>
        </div>
        <div class="pro-detail pay-info" v-if="hostData">
          <div class="info-title">{{lang.cloud_pay_title}}</div>
          <div class="info-item" v-if="hostData.active_time">
            <p class="label">{{lang.cloud_creat_time}}:</p>
            <p class="value" v-time="hostData.active_time"></p>
          </div>
          <div class="info-item" v-if="hostData.due_time">
            <p class="label">{{lang.cloud_due_time}}:</p>
            <p class="value" :class="isRead?'red':''" v-time="hostData.due_time"></p>
          </div>
          <div class="info-item">
            <p class="label">{{lang.cloud_first_pay}}:</p>
            <div class="value">
              {{commonData.currency_prefix + hostData.first_payment_amount +
              commonData.currency_suffix}}
              <span @click="applyCashback" class="common-cashback renew-btn"
                v-if="isShowCashBtn">{{lang.apply_cashback}}</span>
            </div>
          </div>
          <div class="info-item">
            <p class="label">{{lang.cloud_re_text}}:</p>
            <div class="value">
              {{commonData.currency_prefix + hostData.renew_amount + commonData.currency_suffix}}
              <!--  || 'Suspended' -->
              <span v-plugin="'IdcsmartRenew'" v-show="hostData.status == 'Active' || hostData.status == 'Suspended'"
                v-loading="renewBtnLoading" class="renew-btn" @click="showRenew"
                v-if="!refundData || refundData || (refundData && refundData.status=='Cancelled') || (refundData && refundData.status=='Reject')">{{lang.cloud_re_btn}}</span>
              <span v-plugin="'IdcsmartRenew'" v-show="hostData.status == 'Active'" class="renew-btn renew-btn-disable"
                v-else>{{lang.cloud_re_btn}}</span>
            </div>
          </div>
          <div class="info-item">
            <p class="label">{{lang.cloud_pay_style}}:</p>
            <p class="value">{{hostData.billing_cycle_name }}{{lang.common_cloud_text17}}</p>
          </div>
          <div class="info-item" v-show="hostData.status == 'Active'" v-plugin="'IdcsmartRenew'">
            <p class="label">{{lang.common_cloud_text16}}:</p>
            <div class="value">
              <van-switch v-model="isShowPayMsg" @change="autoRenewChange" size=".4rem">
              </van-switch>
              <van-popover placement="top">
                <div class="sure-remind">
                  {{lang.common_cloud_tip15}}
                </div>
                <template #reference>
                  <van-icon name="question" class="help"></van-icon>
                </template>
              </van-popover>
            </div>
          </div>
          <div class="info-item">
            <p class="label">{{lang.cloud_code}}:</p>
            <p class="value" :title="codeString">{{codeString?codeString:'--'}}</p>
          </div>

        </div>

      </div>
    </van-tab>
    <template v-if="!initLoading && hostData.status == 'Active'">
      <van-tab :title="lang.common_cloud_tab1" name="1">
        <div class="page-main echart-box">
          <cur-select v-model:firpick="chartSelectValue" @change="chartSelectChange" :columns="timeOptions">
          </cur-select>
          <div class="echart-main">
            <!-- 网络带宽 -->
            <div id="bw-echart" class="my-echart" v-loading="echartLoading" v-show="isShowChart"></div>
            <van-empty style="width: 100%;" :description="lang.no_data" v-show="!isShowChart"></van-empty>
          </div>
        </div>
      </van-tab>
      <van-tab :title="lang.common_cloud_tab2" name="2">
        <div class="page-main manage-box">
          <!-- 重置密码 -->
          <div class="manage-item">
            <div class="manage-title">
              {{lang.common_cloud_btn12}}
              <p class="manage-des">
                {{lang.common_cloud_tip19}}
                <br>
                {{lang.common_cloud_tip20}}
              </p>
            </div>
            <van-button @click="showRePass" class="manage-btn" type="primary">{{lang.go_set}}</van-button>
          </div>
          <!-- 救援系统 -->
          <div class="manage-item">
            <div class="manage-title">
              <div class="item-top-btn" @click="showRescueDialog" v-if="!isRescue">
                {{lang.common_cloud_btn13}}
              </div>
              <div class="item-top-btn" @click="showQuitRescueDialog" v-else>
                {{lang.common_cloud_btn14}}
              </div>
              <p class="manage-des">
                {{lang.common_cloud_tip21}}
                <br>
                {{lang.common_cloud_tip22}}
              </p>
            </div>
            <van-button @click="showRescueDialog" class="manage-btn" type="primary">{{lang.go_set}}</van-button>
          </div>
          <!-- 重装系统 -->
          <div class="manage-item">
            <div class="manage-title">
              {{lang.common_cloud_btn15}}
              <p class="manage-des">
                {{lang.common_cloud_tip23}}
              </p>
            </div>
            <van-button @click="showReinstall" class="manage-btn" type="primary">{{lang.go_set}}</van-button>
          </div>
          <!-- 升降级 -->
          <div class="manage-item">
            <div class="manage-title">
              {{lang.common_cloud_btn16}}
              <p class="manage-des">
                {{lang.common_cloud_tip24}}
              </p>
            </div>
            <van-button @click="handelUpLicense" :disabled="!isShowProUpdate && !isShowOptionUpdate" class="manage-btn"
              type="primary">{{lang.go_set}}
            </van-button>
          </div>
        </div>
      </van-tab>
      <van-tab :title="lang.common_cloud_tab4" name="4">
        <div class="page-main net-box">
          <div class="ip-box">
            <!-- 公网IP -->
            <div class="net-title">
              <span>{{lang.common_cloud_title3}}</span>
            </div>
            <!-- ipv4 -->
            <div class="net-main">
              <van-list>
                <div class="ip-head">
                  <div class="ip-item-ip">{{lang.common_cloud_label21}}</div>
                  <div class="ip-item-ips">{{lang.common_cloud_label22}}</div>
                  <div class="ip-item-host">{{lang.common_cloud_label23}}</div>
                </div>
                <van-empty v-if="netDataList.length === 0 "></van-empty>
                <div class="ip-item" v-for="item in netDataList">
                  <div class="ip-item-ip">{{item.ip}}</div>
                  <div class="ip-item-ips">{{item.gateway}}</div>
                  <div class="ip-item-host">{{item.subnet_mask}}</div>
                </div>
              </van-list>
            </div>
          </div>
          <!-- 流量图 -->
          <div class="ip-box">
            <div class="net-title">
              <span>{{lang.common_cloud_title4}}</span>
              <van-button type="primary" @click="buyPackage" v-plugin="'FlowPacket'"
                v-if="cloudData.host_data?.bwlimit !== 0 && addonsArr.includes('FlowPacket')" class="flow-btn">
                {{lang.buy_package}}
              </van-button>
            </div>
            <div class="net-main" v-if="cloudData.host_data">
              <div class="flow-box">
                <div class="flow-content">
                  <div class="flow-item">
                    <div class="flow-label">{{lang.common_cloud_label24}}:</div>
                    <div class="flow-value" v-if="cloudData.host_data.bwlimit * 1 === 0">{{lang.common_cloud_title46}}
                    </div>
                    <div class="flow-value" v-else>{{(cloudData.host_data.bwlimit * 1).toFixed(2)}}GB</div>
                  </div>
                  <div class="flow-item">
                    <div class="flow-label">{{lang.common_cloud_label25}}:</div>
                    <div class="flow-value" v-if="cloudData.host_data.bwlimit * 1 === 0">{{lang.common_cloud_title46}}
                    </div>
                    <div class="flow-value" v-else>{{(cloudData.host_data.bwlimit * 1 - cloudData.host_data.bwusage *
                      1).toFixed(2)}}GB</div>
                  </div>
                  <!-- <div class="flow-item">
                    <div class="flow-label">{{lang.common_cloud_label26}}:</div>
                    <div class="flow-value">{{flowData.reset_flow_date}}</div>
                  </div> -->
                </div>
                <div class="time-select">
                  <cur-select v-model:firpick="chartSelectValue" @change="chartSelectChange" :columns="timeOptions">
                  </cur-select>
                </div>
                <div class="echart-main">
                  <!-- 网络带宽 -->
                  <div id="bw2-echart" class="my-echart" v-loading="echartLoading3"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </van-tab>
      <van-tab :title="lang.common_cloud_tab6" name="6">
        <div class="page-main dist-box">
          <div class="net-main">
            <van-empty v-if="logDataList.length === 0 && logFinished"></van-empty>
            <van-list v-else v-model:loading="logLoading" :finished="logFinished" @load="getLogList"
              :immediate-check="false">
              <div class="yes-disk">
                <div class="disk-item" v-for="item in logDataList">
                  <div class="disk-name">
                    <span>ID:{{item.id}}</span>
                  </div>
                  <div class="disk-info">
                    <div class="disk-time">
                      <div class="disk-lebal">{{lang.common_cloud_label34}}：</div>
                      <div class="disk-value">{{item.description}}</div>
                    </div>
                    <div class="disk-time">
                      <div class="disk-lebal">{{lang.common_cloud_label33}}：</div>
                      <div class="disk-value" v-time="item.create_time">{{item.create_time}}</div>
                    </div>
                  </div>

                </div>
              </div>
            </van-list>
          </div>
        </div>
      </van-tab>
    </template>
  </van-tabs>



  <!-- 重置密码 -->
  <van-popup v-model:show="isShowRePass" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">
        {{lang.common_cloud_title13}}
        <p class="dia-text-tip">{{lang.common_cloud_text23}}</p>
      </div>
      <div class="pop-body">
        <div class="reset-box">
          <van-field class="btn-field" v-model="rePassData.password" :label="lang.common_cloud_label7" label-align="top"
            :placeholder="lang.common_cloud_text47">
            <template #button>
              <div class="pass-btn" slot="suffix" @click="autoPass">
                {{lang.common_cloud_btn1}}
              </div>
            </template>
          </van-field>
          <!-- 警告框 -->
          <div class="com-danger-btn" v-show="powerStatus=='off'">
            <div class="alert-text">{{lang.common_cloud_tip30}}</div>
            <div class="item"><span class="dot"></span> {{lang.common_cloud_tip31}}</div>
            <div class="item"><span class="dot"></span> {{lang.common_cloud_tip32}}</div>
          </div>
          <van-checkbox v-show="powerStatus=='off'" class="check-box" v-model="rePassData.checked" shape="square"
            icon-size=".4267rem">
            {{lang.common_cloud_text24}}
          </van-checkbox>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="rePassDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="rePassSub" :loading="loading5">{{
        lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 救援系统 -->
  <van-popup v-model:show="isShowRescue" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">
        {{lang.common_cloud_tab7}}
        <p class="dia-text-tip">{{lang.common_cloud_tip34}}</p>
      </div>
      <div class="pop-body">
        <div class="reset-box">
          <cur-select :label="lang.common_cloud_tab8" label-align="top" v-model:firpick="rescueData.type"
            :columns="osOptions" cur-class="select-field select-div" :clearable="false">
            <template #input>
              <div class="os-item">
                <img class="item-os-img"
                  :src="`/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/${rescueData.type === '1' ? 'Windows' : 'Linux'}.png`"
                  alt="">
                <span class="item-os-text">{{rescueData.type === '1' ? 'Windows' : 'Linux'}}</span>
              </div>
            </template>
            <template #option="option">
              <div class="os-item">
                <img class="item-os-img"
                  :src="`/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/mf_cloud/${option.text}.png`"
                  alt="">
                <span class="item-os-text">{{option.text}}</span>
              </div>
            </template>
          </cur-select>
          <!-- <van-field :label="lang.common_cloud_tab9" label-align="top" class="btn-field" v-model="rescueData.temp_pass"
            :placeholder="lang.common_cloud_text47">
            <template #button>
              <div class="pass-btn" slot="suffix" @click="autoPass">
                {{lang.common_cloud_btn1}}
              </div>
            </template>
          </van-field>
          <div class="com-reset-password">
            {{lang.common_cloud_tip29}}
          </div> -->
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="rescueDgClose">{{lang.withdraw_btn2}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="rescueSub" :loading="loading3">{{
          lang.withdraw_btn1}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 重装系统 -->
  <van-popup v-model:show="isShowReinstallDialog" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_title9}}</div>
      <div class="pop-body">
        <div class="reset-box">
          <van-field :label="lang.common_cloud_label6" right-icon="arrow" @click="isShowImage = true" readonly
            label-align="top">
            <template #input>
              <div class="os-item">
                <img class="item-os-img" :src="osIcon" alt="">
                <span class="item-os-text">{{osName}}</span>
              </div>
            </template>
          </van-field>
          <cur-select v-model:firpick="reinstallData.type" :columns="passOption" cur-class="select-field select-div"
            :clearable="false" :label="lang.common_cloud_label7" label-align="top">
          </cur-select>
          <cur-select v-if="reinstallData.type === 'key'" v-model:firpick="reinstallData.ssh_key_id"
            :columns="sshKeyData" :columns-names="{text: 'name', value: 'id'}" cur-class="select-field select-div"
            :clearable="false">
          </cur-select>
          <van-field class="btn-field" v-model="reinstallData.password" :placeholder="lang.common_cloud_text47" v-else>
            <template #button>
              <div class="pass-btn" slot="suffix" @click="autoPass">
                {{lang.common_cloud_btn1}}
              </div>
            </template>
          </van-field>
          <van-field class="btn-field" v-model="reinstallData.port" :placeholder="lang.common_cloud_text46"
            :label="lang.common_cloud_label13" label-align="top">
            <template #button>
              <div class="pass-btn" slot="suffix" @click="autoPort">
                {{lang.common_cloud_btn1}}
              </div>
            </template>
          </van-field>
          <template v-if="isWindows">
            <van-field :label="lang.op_tips2" label-align="top">
              <template #input>
                <van-radio-group style="row-gap: .2133rem;" v-model="reinstallData.part_type" direction="horizontal"
                  shape="square">
                  <van-radio :name="0">{{lang.op_tips3}}</van-radio>
                  <van-radio :name="1">{{lang.op_tips4}}</van-radio>
                </van-radio-group>
              </template>
            </van-field>
          </template>
          <!-- <van-field v-if="cloudConfig.reinstall_sms_verify === 1" class="btn-field" v-model="reinstallData.code"
            :label="lang.ticket_label19" label-align="top" :placeholder="lang.account_tips33">
            <template #button>
              <div class="pass-btn" slot="suffix" v-if="isSendCodeing">{{sendTime}}{{lang.account_tips54}}</div>
              <div class="pass-btn" slot="suffix" v-loading="sendFlag" @click="sendCode" v-else>
                {{lang.account_tips55}}
              </div>
            </template>
          </van-field> -->
          <div class="pay-img" v-show="isPayImg">
            <div class="left">
              <span>
                {{lang.common_cloud_tip28}},{{commonData.currency_prefix + payMoney + lang.common_cloud_text26}}
              </span>
              <van-popover placement="top">
                <div class="sure-remind">
                  <div class="show-config-list">{{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}}{{
                    payDiscount }}</div>
                  <div class="show-config-list">{{lang.common_cloud_text28}}：{{commonData.currency_prefix}}{{
                    payCodePrice }}</div>
                </div>
                <template #reference>
                  <van-icon name="question" class="help" v-show="isShowLevel || isShowPromo"></van-icon>
                </template>
              </van-popover>
            </div>
            <span class="img-buy-btn" @click="payImg">{{lang.common_cloud_btn5}}</span>
          </div>
          <div class="com-reset-password">
            <span class="tip-text">{{lang.common_cloud_tip43}} {{lang.common_cloud_tip29}}</span>
          </div>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="reinstallDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="doReinstall"
          :loading="loading6">{{lang.common_cloud_btn28}}
        </van-button>
      </div>
    </div>

  </van-popup>



  <!-- 升降级弹窗 -->
  <van-popup v-model:show="upLicenseDialogShow" round closeable style="width: 90%;">
    <div class="common-pop-box">
      <div class="common-pop-title">
        {{lang.common_cloud_btn16}}
      </div>
      <div class="common-pop-body">
        <div class="license-box" style="max-height: 60vh; overflow-y: auto;">
          <!-- <div class="now-lincense">
            <div class="lincense-content">
              <div class="content-title">{{hostData.product_name}}</div>
              <div class="content-box">
                <div class="content-item" v-for="(item,index) in upgradeList" :key="index + 'upgradeConfig'">
                  {{item.option_name}}
                  <span>{{calcValue(item)}}{{item.unit}}</span>
                </div>
              </div>
            </div>
          </div> -->
          <van-tabs v-model:active="licenseActive" @change="handleTabClick" line-width="16px"
            title-active-color="var(--van-primary-color)">
            <van-tab :title="lang.common_cloud_text231" name="2" v-if="isShowOptionUpdate">
              <van-form ref="orderForm" scroll-to-error>
                <template v-for="item in configoptions">
                  <!-- 下拉/单选 点击单选 -->
                  <cur-select v-model:firpick="configForm[item.id]" @change="()=>changeItem(item)"
                    v-if="item.option_type === 1 || item.option_type === 2 || item.option_type === 6 || item.option_type === 8 || item.option_type === 10 || item.option_type === 13"
                    :columns="item.sub" :columns-names=" { text: 'option_name', value: 'id' }" input-align="right"
                    right-icon="arrow" :label="item.option_name" cur-class=" ">
                  </cur-select>
                  <!-- 是否 -->
                  <van-field :label="item.option_name" input-align="right" v-if="item.option_type === 3">
                    <template #input>
                      <van-switch v-model="configForm[item.id]" size="16px" :active-value="1" :inactive-value="0"
                        @change="changeConfig">
                      </van-switch>
                      <!-- 后缀单位 -->
                      <div class="unit" v-if="item.unit">{{item.unit}}</div>
                    </template>
                  </van-field>
                  <!-- 数量拖动 -->
                  <van-field label-align="top" v-if="item.option_type === 4 || item.option_type === 7 || item.option_type === 9 || item.option_type === 11 ||
                  item.option_type === 14 || item.option_type === 15 || item.option_type === 16 || item.option_type === 17
                  || item.option_type === 18 || item.option_type === 19">
                    <template #label>
                      <div class="lebal-box">
                        <span>{{item.option_name}}</span>
                        <van-stepper v-model="configForm[item.id]" :min="calcMin(item)" :max="item.qty_maximum"
                          @change="(val)=>changeNumStepper(val,item)">
                        </van-stepper>
                      </div>
                    </template>
                    <template #input>
                      <div class="slider-input">
                        <div class="slider-box">
                          <van-slider v-model="configForm[item.id]" :min="calcMin(item)" :max="item.qty_maximum"
                            bar-height=".1067rem" @change="(val)=>changeNumStepper(val,item)">
                            <template #button>
                              <div class="custom-button">{{ configForm[item.id]}}</div>
                            </template>
                          </van-slider>
                          <div class="unit" v-if="item.unit">{{item.unit}}</div>
                        </div>
                        <div class="marks">
                          <span class="item">{{item.qty_minimum}} <span v-if="item.unit">{{item.unit}}</span></span>
                          <span class="item">{{item.qty_maximum}} <span v-if="item.unit">{{item.unit}}</span></span>
                        </div>
                      </div>
                    </template>
                  </van-field>
                  <!-- 双下拉 操作系统-->
                  <van-field v-if="item.option_type === 5" :label="item.option_name" class="select-field primary-field "
                    right-icon="arrow" @click="clickOsItem(item)" readonly label-align="top">
                    <template #input>
                      <div class="primary-color">
                        <img :src="osIcon" alt="" class="image-icon" v-if="osIcon" />
                        {{imageName}}
                      </div>
                    </template>
                  </van-field>
                  <!-- 数据中心 -->
                  <cur-select :columns="item.sub" :label="item.option_name" label-align="top"
                    v-if="item.option_type === 12" :columns-names="{text:'option_name',value:'id'}" right-icon="arrow"
                    cur-class="select-field  mar-0 primary-field" @change="(e)=>changeArea(item.id,e)">
                    <template #input>
                      <div class="select-input">
                        <img v-if="areImg" :src="`/upload/common/country/${areImg}.png`" alt="" class="country-icon">
                        {{countryName}}
                      </div>
                    </template>
                    <template #option="option">
                      <img v-if="option.country_code" :src="`/upload/common/country/${option.country_code}.png`" alt=""
                        class="country-icon">
                      {{option.option_name}}
                    </template>
                  </cur-select>
                  <!-- 单选级联 -->
                  <template v-if="item.option_type === 20">
                    <cur-select v-model:firpick="configForm[item.id]" @change="(e)=>cascaderClick(item.id,e[0].id,item)"
                      :columns="item.sub" :columns-names=" { text: 'option_name', value: 'id' }" input-align="right"
                      right-icon="arrow" :label="item.option_name" cur-class=" ">
                    </cur-select>
                    <template v-if="item.sonData.length">
                      <template v-for="(son,ind) in item.sonData">
                        <cur-select v-model:firpick="cascaderObj[item.id].son[son.id]"
                          @change="(e)=>cascaderSonClick(item.id,son.id,e[0])" :columns="son.sub"
                          :columns-names=" { text: 'option_name', value: 'id' }" input-align="right" right-icon="arrow"
                          :label="son.option_name" cur-class=" ">
                        </cur-select>
                      </template>
                    </template>
                  </template>
                </template>
              </van-form>
            </van-tab>
          </van-tabs>
        </div>
        <div class="order-money">
          <div class="money-text">{{lang.common_cloud_btn37}}：</div>
          <div class="money" v-show="!upgradePriceLoading">
            <span class="money-num">{{commonData.currency_prefix }} {{ filterMoney(upParams.totalPrice)}}</span>
            <van-popover placement="left-end">
              <div class="sure-remind">
                <p v-if="isShowLevel">{{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}}
                  {{filterMoney(upParams.clDiscount) }}
                </p>
                <p v-if="isShowPromo && upParams.isUseDiscountCode">
                  {{lang.shoppingCar_tip_text4}}：{{commonData.currency_prefix}}
                  {{ filterMoney(upParams.code_discount)}}
                </p>
                <p v-if="isShowCash && upParams.customfield.voucher_get_id">
                  {{lang.shoppingCar_tip_text5}}：{{commonData.currency_prefix}}
                  {{filterMoney( upParams.cash_discount )}}
                </p>
              </div>
              <template #reference>
                <van-icon name="info-o" class="help"
                  v-if="upParams.clDiscount || upParams.code_discount || upParams.cash_discount"></van-icon>
              </template>
            </van-popover>
            <p class="original-price" v-if="upParams.totalPrice != upParams.original_price">
              {{commonData.currency_prefix}} {{filterMoney(upParams.original_price) }}
            </p>
            <div class="code-box">
              <!-- 代金券 -->
              <cash-coupon ref="cashRef" v-show="isShowCash && !cashObj.code"
                :currency_prefix="commonData.currency_prefix" @use-cash="upUseCash" scene="upgrade"
                :product_id="[product_id]" :price="upParams.original_price">
              </cash-coupon>
              <!-- 优惠码 -->
              <discount-code placement="top-end" v-show="isShowPromo && !upParams.customfield.promo_code"
                @get-discount="getUpDiscount" scene='upgrade' :product_id="product_id" :amount="upParams.original_price"
                :billing_cycle_time="hostData.billing_cycle_time"></discount-code>
            </div>
            <div class="code-number-text">
              <div class="discount-codeNumber" v-show="upParams.customfield.promo_code">
                {{ upParams.customfield.promo_code }}
                <van-icon name="close" class="remove-discountCode" @click="removeUpDiscountCode()"></van-icon>
              </div>
              <div class="cash-codeNumber" v-show="cashObj.code">{{ cashObj.code }}
                <van-icon name="close" class="remove-discountCode" @click="upRemoveCashCode()"></van-icon>
              </div>
            </div>
          </div>
          <van-loading v-show="upgradePriceLoading"></van-loading>
        </div>
      </div>
      <div class="common-pop-fotter">
        <van-button class="can-btn" block @click="upgradeDgClose">
          {{lang.finance_btn7}}
        </van-button>
        <van-button class="sub-btn" block type="primary" @click="upgradeSub" :loading="loading4">
          {{ lang.finance_btn6}}
        </van-button>
      </div>
    </div>
  </van-popup>
  <!-- 修改备注弹窗 -->
  <van-popup v-model:show="isShowNotesDialog" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text"> {{hostData.notes?lang.common_cloud_title7:lang.common_cloud_title8}}</div>
      <div class="pop-body">
        <div class="label">{{lang.common_cloud_label29}}</div>
        <van-field class="dia-field" v-model="notesValue"></van-field>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="notesDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subNotes">{{lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 停用弹窗（删除实例） -->
  <van-popup v-model:show="isShowRefund" round closeable style="width: 90%;" @closed="refundDgClose">
    <div class="pop-box">
      <div class="dia-text">
        {{refundPageData.allow_refund == 1 ? lang.common_cloud_title11 : lang.common_cloud_title12}}
      </div>
      <div class="pop-body">
        <div class="refund-box">
          <div class="label">{{lang.common_cloud_label35}}</div>
          <div class="host-content">
            <div class="host-item" v-for="(item, index) in refundPageData.configs">
              <div class="left">{{item.name}}:</div>
              <div class="right">{{item.value}}</div>
            </div>
          </div>
          <cur-select label-align="top" :label="lang.common_cloud_label39" v-model:firpick="refundParams.suspend_reason"
            cur-class="cur-select" v-if="refundPageData.reason_custom == 0" :columns="refundPageData.reasons"
            :columns-names="{text: 'content', value: 'id'}">
          </cur-select>
          <van-field label-align="top" :label="lang.common_cloud_label39" class="dia-field" v-else
            v-model="refundParams.suspend_reason">
          </van-field>
          <cur-select v-model:firpick="refundParams.type" label-align="top" :label="lang.common_cloud_label40"
            cur-class="cur-select" :columns="showSuspendOption">
          </cur-select>
          <template v-if="refundPageData.allow_refund == 1">
            <div class="label">{{lang.common_cloud_label43}}</div>
            <div class="amount-content">
              {{commonData.currency_prefix}}{{refundParams.type=='Immediate'?refundPageData.host.amount:'0.00'}}
            </div>
          </template>
          <div class="label" style="color: var(--base-color-danger);" v-show="refundPageData.allow_refund === 0">
            {{lang.refund_tip}}
          </div>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="refundDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subRefund">{{refundPageData.allow_refund == 1 ?
          lang.common_cloud_btn31 : lang.common_cloud_btn32}}</van-button>
      </div>
    </div>

  </van-popup>
  <!-- 续费弹窗 -->
  <van-popup v-model:show="isShowRenew" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_title10}}</div>
      <div class="pop-body">
        <div class="renew-content">
          <div class="renew-item" :class="renewActiveId===index?'renew-active':''" v-for="(item,index) in renewPageData"
            :key="index" @click="renewItemChange(item,index)">
            <div class="item-top">{{item.customfield?.multi_language?.billing_cycle || item.billing_cycle}}</div>
            <div class="item-bottom" v-if="isShowPromo && renewParams.isUseDiscountCode">
              {{commonData.currency_prefix + item.base_price}}
            </div>
            <div class="item-bottom" v-else>{{commonData.currency_prefix + item.price}}</div>
            <div class="item-origin-price" v-if="item.price*1 < item.base_price*1 && !renewParams.isUseDiscountCode">
              {{commonData.currency_prefix + item.base_price}}
            </div>
            <i class="el-icon-check check" v-show="renewActiveId===index"></i>
          </div>
        </div>
        <div class="order-money renew-money">
          <div class="money-text">{{lang.common_cloud_label11}}：</div>
          <div class="money" v-show="!renewLoading">
            <span class="money-num">{{commonData.currency_prefix }} {{ filterMoney(renewParams.totalPrice)}}</span>
            <van-popover placement="left-end">
              <div class="sure-remind">
                <p v-if="isShowLevel && renewParams.clDiscount*1 > 0">
                  {{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}}
                  {{filterMoney(renewParams.clDiscount) }}
                </p>
                <p v-if="isShowPromo && renewParams.isUseDiscountCode">
                  {{lang.shoppingCar_tip_text4}}：{{commonData.currency_prefix}} {{
                  filterMoney(renewParams.code_discount)}}
                </p>
                <p v-if="isShowCash && renewParams.customfield.voucher_get_id">
                  {{lang.shoppingCar_tip_text5}}：{{commonData.currency_prefix}} {{filterMoney( renewParams.cash_discount
                  ) }}
                </p>
              </div>
              <template #reference>
                <van-icon name="info-o" class="help"
                  v-if="renewParams.clDiscount || renewParams.code_discount || renewParams.code_discount"></van-icon>
              </template>
            </van-popover>
            <p class="original-price"
              v-if="renewParams.customfield.promo_code && renewParams.totalPrice != renewParams.base_price">
              {{commonData.currency_prefix}} {{filterMoney(renewParams.base_price) }}
            </p>
            <p class="original-price"
              v-if="!renewParams.customfield.promo_code && renewParams.totalPrice != renewParams.original_price">
              {{commonData.currency_prefix}} {{filterMoney(renewParams.original_price) }}
            </p>
            <div class="code-box">
              <!-- 代金券 -->
              <cash-coupon ref="cashRef" v-show="isShowCash && !cashObj.code"
                :currency_prefix="commonData.currency_prefix" @use-cash="reUseCash" scene="renew"
                :product_id="[product_id]" :price="renewParams.original_price">
              </cash-coupon>
              <!-- 优惠码 -->
              <discount-code placement="left-start" v-show="isShowPromo && !renewParams.customfield.promo_code"
                @get-discount="getRenewDiscount" scene='renew' :product_id="product_id" :amount="renewParams.base_price"
                :billing_cycle_time="renewParams.duration">
              </discount-code>
            </div>
            <div class="code-number-text">
              <span class="discount-codeNumber" v-show="renewParams.customfield.promo_code">
                {{ renewParams.customfield.promo_code }}
                <van-icon name="close" class="remove-discountCode" @click="removeRenewDiscountCode()"></van-icon>
              </span>
              <span class="cash-codeNumber" v-show="cashObj.code">
                {{ cashObj.code }}
                <van-icon name="close" class="remove-discountCode" @click="reRemoveCashCode()"></van-icon>
              </span>
            </div>
          </div>
          <van-loading v-show="renewLoading"></van-loading>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="renewDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" :loading="renewSubLoading"
          @click="subRenew">{{ lang.common_cloud_btn30}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 电源操作确认弹窗 -->
  <van-popup v-model:show="isShowPowerChange" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{powerTitle}}{{lang.cloud_menu_1}}</div>
      <div class="pop-body">
        <div class="s-tip">{{lang.common_cloud_text34}}&nbsp;{{powerTitle}}&nbsp;{{lang.common_cloud_text35}}</div>
        <div class="content">
          <div class="l-icon">
            <img src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloudDetail/host.png"
              alt="">
          </div>
          <div class="info">
            <p class="text">
              {{hostData.name}}
              <van-tag :type="calcPower(status)" class="tag-button">{{status}}</van-tag>
            </p>
            <p class="ip">{{cloudData.ip}}</p>
          </div>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="powerDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="toChangePower" :loading="loading1">{{
          lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 退出救援模式弹窗 -->
  <van-popup v-model:show="isShowQuit" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_btn14}}</div>
      <div class="pop-body">

      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="quitDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="reQuitSub">{{ lang.common_cloud_btn34}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 挂载磁盘 -->
  <van-popup v-model:show="isShwoMountDisk" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_title16 + lang.common_cloud_tab3}}</div>
      <div class="pop-body">
        <div class="label">{{lang.select_instance}}</div>
        <cur-select :text="curCloudName" :clearable="false" disabled>
        </cur-select>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="isShwoMountDisk = false">{{lang.common_cloud_text181}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subMount" :loading="mountLoading">{{
          lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 卸载磁盘 -->
  <van-popup v-model:show="isShwoUnmountDisk" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text danger-color">
        <van-icon name="warning-o"></van-icon>
        {{lang.common_cloud_title17 + lang.common_cloud_tab3}}
      </div>
      <div class="pop-body">
        <div class="tip-box">
          <span class="item-1">{{lang.common_cloud_title17 + lang.common_cloud_tab3}}: <span
              class="name">{{curDisk.name}}</span></span>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="isShwoUnmountDisk = false">{{lang.common_cloud_text181}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subUnmount" :loading="mountLoading">{{
          lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 扩容磁盘弹窗 -->
  <van-popup v-model:show="isShowExpansion" closeable round style="width: 90%;" @closed="krClose">
    <div class="pop-box kr-box">
      <div class="dia-text">
        {{lang.common_cloud_btn42 }}
      </div>
      <div class="pop-body">
        <div class="kr-disk-list">
          <div class="disk-item" v-for="(item,index) in oldDiskList">
            <div class="disk-name">{{lang.common_cloud_label18}}:{{item.name}}</div>
            <div class="disk-num">
              <span class="disk-left">{{lang.common_cloud_label20}}(GB):</span>
              <template
                v-if="item.type2 ==='data' && item.selectList.length > 0 && (item.selectList[0].type === 'total' || item.selectList[0].type === 'step')">
                <van-stepper v-model="item.size" :min="item.min_value" :max="item.max_value"
                  @change="(val)=>sliderChange(val,item)">
                </van-stepper>
              </template>
              <template
                v-if="item.type2 ==='data' && item.selectList.length > 0 && item.selectList[0].type === 'radio'">
                <cur-select v-model:firpick="item.size" :text="item.size + 'GB'"
                  v-if="item.selectList[0].type === 'radio'" :clearable="false" :columns="item.selectList"
                  :columns-names=" { text: 'value',value: 'value' }">
                  <template #option="option">
                    <span>{{option.value + 'GB'}}</span>
                  </template>
                </cur-select>
              </template>
              <template v-if="item.selectList.length === 0">
                <span>{{lang.common_cloud_btn68}}</span>
              </template>
              <div class="disk-tips">
                <span class="tips" v-if="item.tips && item.selectList.length !== 0">({{item.tips}})</span>
              </div>
            </div>
          </div>
        </div>
        <div class="kr-price">
          <div class="kr-bottom-text">{{lang.common_cloud_btn44}}:</div>
          <div class="kr-bottom-num" v-show="!diskPriceLoading">
            {{commonData.currency_prefix}}{{(expansionDiskPrice * 1).toFixed(2)}}
            <van-popover placement="top">
              <div class="sure-remind">
                <div class="show-config-list">
                  {{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}}{{expansionDiscount }}
                </div>
                <div class="show-config-list">{{lang.common_cloud_text28}}：{{commonData.currency_prefix}}{{
                  expansionCodePrice }}</div>
              </div>
              <template #reference>
                <van-icon name="info-o" class="help" v-show="isShowLevel || isShowPromo"></van-icon>
              </template>
            </van-popover>
          </div>
          <van-loading v-show="diskPriceLoading"></van-loading>
        </div>
        <div class="pop-fotter">
          <van-button class="can-btn" block @click="krClose">{{lang.common_cloud_text181}}</van-button>
          <van-button class="sub-btn" block type="primary" @click="subExpansion">
            {{ lang.common_cloud_btn28}}</van-button>
        </div>
      </div>
    </div>

  </van-popup>
  <!-- 订购磁盘弹窗 -->
  <van-popup v-model:show="isShowDg" closeable round style="width: 90%;" @closed="dgClose">
    <div class="pop-box kr-box">
      <div class="dia-text">
        {{lang.common_cloud_btn22 }}
      </div>
      <div class="pop-body">
        <div class="kr-disk-list">
          <div class="disk-item" v-for="(item,index) in oldDiskList2">
            <div class="add-disk-box">
              <div class="origin-disk">
                <span class="disk-item-text">{{item.name}}</span>
                <span class="disk-item-size">{{item.size + 'G'}}</span>
              </div>
              <img class="del-icon" v-if="item.type2 !== 'system'" @click="delOldSize2(item.id)"
                src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloud/del-disk.svg" alt="">
            </div>
          </div>
          <div class="disk-item" v-for="(item,index) in moreDiskData">
            <div class="add-disk-box">
              <div class="add-left">
                <div class="disk-type">
                  <span class="disk-left">{{lang.disk_type}}</span>
                  <cur-select v-model:firpick="item.type" :clearable="false"
                    :columns="calcDiskType(item.selectList[0].disk_typeList)" @change="(val)=>changeType(val,item)">
                  </cur-select>
                </div>
                <div class="disk-num">
                  <span class="disk-left">{{lang.common_cloud_label20}}(GB):</span>
                  <cur-select v-model:firpick="item.size" v-if="item.selectList[0].type === 'radio'" :clearable="false"
                    :columns="item.selectList[0][item.type]" :columns-names=" { text: 'label',value: 'value' }">
                  </cur-select>
                  <van-popover placement="top" v-else>
                    <div class="sure-remind">
                      {{lang.mf_range + item.selectList[0][item.type].tips}}
                    </div>
                    <template #reference>
                      <van-stepper v-model.number="item.size" :min="item.selectList[0][item.type].min_value"
                        :before-change="(val)=>changeDataNum(val,item)" :max="item.selectList[0][item.type].max_value">
                      </van-stepper>
                    </template>
                  </van-popover>
                </div>
              </div>
              <img class="del-icon" @click="delMoreDisk(item.index)"
                src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cloud/del-disk.svg" alt="">
            </div>
          </div>


          <div class="add-disk-btn" @click="addMoreDisk">
            <van-icon name="add-o"></van-icon>
          </div>
        </div>
        <div class="kr-price">
          <div class="kr-bottom-text">{{lang.common_cloud_btn41}}:</div>
          <div class="kr-bottom-num" v-show="!diskPriceLoading">
            {{commonData.currency_prefix}}{{(moreDiskPrice * 1).toFixed(2)}}
            <van-popover placement="top">
              <div class="sure-remind">
                <div class="show-config-list">
                  {{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}}{{moreDiscountkDisPrice }}
                </div>
                <div class="show-config-list">{{lang.common_cloud_text28}}：{{commonData.currency_prefix}}{{
                  moreCodePrice }}</div>
              </div>
              <template #reference>
                <van-icon name="info-o" class="help" v-show="isShowLevel || isShowPromo"></van-icon>
              </template>
            </van-popover>
          </div>
          <van-loading v-show="diskPriceLoading"></van-loading>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="dgClose">{{lang.common_cloud_text181}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="toCreateDisk">
          {{ lang.product_buy_now}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 新增附加IP -->
  <van-popup v-model:show="isShowIp" round closeable style="width: 90%;" @closed="ipClose">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_title39}}</div>
      <div class="pop-body">
        <!-- ipv4 -->
        <div class="ip-label" v-if="ipValueData.length > 0">
          {{lang.common_cloud_title40}} {{ipDetails.ip_num - cloudData.ipv6_num}}
          {{lang.common_cloud_title43 + ',' +
            lang.common_cloud_title41}}：{{cloudData.ip_num}}{{lang.common_cloud_title43
          + ',' +lang.common_cloud_title42}}
        </div>
        <div class="ip-main-card" v-if="ipValueData.length > 0">
          <template v-if="ipValueData[0].type === 'radio'">
            <div class="ip-item" :class="ipValue === item.value ? 'active' : ''" v-for="item in ipValueData"
              :key="item.value" @click="selectIpValue(item.value)">
              {{item.value}} {{lang.common_cloud_title43}}
            </div>
          </template>

          <van-popover placement="top" v-else>
            <div class="sure-remind">
              {{lang.mf_range + ipv4Tip}}
            </div>
            <template #reference>
              <van-stepper v-model.number="ipValue" :step="1" :min="ipValueData[0].min_value"
                :max="ipValueData[ipValueData.length - 1].max_value" :before-change="(val)=>changeIpNum('ipv4', val)">
              </van-stepper>
            </template>
          </van-popover>
        </div>
        <!-- ipv6 -->
        <template v-if="ipv6ValueData.length > 0 && cloudData.network_type !== 'vpc'">
          <div class="ip-label">
            {{lang.cur_ipv6}} {{cloudData.ipv6_num}}
            {{lang.common_cloud_title43 + ',' +
              lang.common_cloud_title41}}：{{cloudData.ipv6_num}}{{lang.common_cloud_title43
            + ',' +lang.cur_ipv6_tip}}
          </div>
          <div class="ip-main-card">
            <template v-if="ipv6ValueData[0].type === 'radio'">
              <div class="ip-item" :class="ipv6Value === item.value ? 'active' : ''" v-for="item in ipv6ValueData"
                :key="item.value" @click="selectIpv6Value(item.value)">
                {{item.value}} {{lang.common_cloud_title43}}
              </div>
            </template>
            <van-popover placement="top" v-else>
              <div class="sure-remind">
                {{lang.mf_range + ipv6Tip}}
              </div>
              <template #reference>
                <van-stepper v-model.number="ipv6Value" :step="1" :min="ipv6ValueData[0].min_value" class="ip-slider"
                  :max="ipv6ValueData[ipv6ValueData.length - 1].max_value"
                  :before-change="(val)=>changeIpNum('ipv6', val)">
                </van-stepper>
              </template>
            </van-popover>
          </div>
        </template>
      </div>
      <div class="ip-price-box">
        <div class="kr-bottom-text">{{lang.common_cloud_title44}}:</div>
        <div class="kr-bottom-num" v-show="!ipPriceLoading">
          {{commonData.currency_prefix}}{{ipMoney >=0 ? ipMoney : 0}}
          <van-popover placement="top">
            <div class="sure-remind">
              <div class="show-config-list">
                {{lang.common_cloud_text27}}：{{commonData.currency_prefix}}{{ipDiscountkDisPrice }}
              </div>
              <div class="show-config-list">{{lang.common_cloud_text28}}：{{commonData.currency_prefix}}{{
                ipCodePrice
                }}
              </div>
            </div>
            <template #reference>
              <van-icon name="info-o" class="help" v-show="isShowLevel || isShowPromo"></van-icon>
            </template>
          </van-popover>
        </div>
        <van-loading v-show="ipPriceLoading"></van-loading>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="ipClose">{{lang.common_cloud_text181}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subAddIp">{{ lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 删除VPC弹窗 -->
  <van-popup v-model:show="isShowVpcDel" round closeable style="width: 90%;" @close="vpcDelClose">
    <div class="del-pop">
      <div class="dia-text">
        <van-icon name="warning-o"></van-icon>
        {{lang.mf_tip34}}
      </div>
      <div class="fotter-btn dia-fotter">
        <van-button class="can-btn" @click="vpcDelClose">{{lang.security_btn6}}</van-button>
        <van-button class="sub-btn" :loading="delVpcLoading" type="danger"
          @click="handDelVpc">{{lang.security_btn9}}</van-button>
      </div>
    </div>
  </van-popup>

  <!-- 分配主机 -->
  <van-popup v-model:show="isShowengine" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_title35}}</div>
      <div class="pop-body">
        <div class="engine-label">{{lang.common_cloud_title36}}</div>
        <div class="engine-select">
          <span class="select-title">{{lang.common_cloud_title37}}：</span>
          <cur-select v-model:firpick="engineID" cur-class="cur-select" :columns-names="{text: 'name', value: 'id'}"
            :columns="productOptions">
          </cur-select>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="engineClose">{{lang.subaccount_text32}}</van-button>
        <van-button class="sub-btn" block type="primary" :loading="isSubmitEngine" @click="subAddEngine">{{
          lang.subaccount_text31}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 新增VPC网络 -->
  <van-popup v-model:show="isShowAddVpc" round closeable style="width: 95%;" @closed="addVpcClose">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_title20}}</div>
      <div class="pop-body">
        <div class="vpc-item">
          <span class="vpc-leabel">{{lang.common_cloud_title32}}：</span>
          <span class="vpc-value">{{vpcName}}</span>
        </div>
        <div class="vpc-item">
          <span class="vpc-leabel">{{lang.common_cloud_title33}}：</span>
          <cur-select cur-class="cur-select" v-model:firpick="plan_way" :columns-names="{text: 'name', value: 'id'}"
            :columns="planWayOptions">
          </cur-select>
        </div>
        <div class="vpc-item ip-custom" v-if="plan_way === 1">
          <span class="vpc-leabel">{{lang.common_cloud_title34}}：</span>
          <div class="vpc">
            <!-- 自定义vpc -->
            <div class="custom">
              <cur-select cur-class="custom-select" v-model:firpick="vpc_ips.vpc1.value" @change="changeVpcIp"
                :columns="vpc_ips.vpc1.select">
              </cur-select>
              <span class="ip-dot">·</span>
              <van-popover placement="top">
                <div class="sure-remind">
                  {{vpc_ips.vpc1.tips}}
                </div>
                <template #reference>
                  <van-field :disabled="vpc_ips.vpc1.value === 192" v-model="vpc_ips.vpc2" :step="1"
                    :formatter="vpcFormatter" format-trigger="onBlur" :controls="false" :min="vpc_ips.min"
                    :max="vpc_ips.max" type="digit">
                  </van-field>
                </template>
              </van-popover>
              <span class="ip-dot">·</span>
              <van-popover placement="top">
                <div class="sure-remind">
                  {{vpc_ips.vpc3Tips}}
                </div>
                <template #reference>
                  <van-field :disabled="vpc_ips.vpc6.value === 16" @blur="changeVpc3" :formatter="vpc2Formatter"
                    v-model="vpc_ips.vpc3" :step="1" format-trigger="onBlur" :controls="false" :min="0"
                    :max="255"></van-field>
                </template>
              </van-popover>
              <span class="ip-dot">·</span>
              <van-popover placement="top">
                <div class="sure-remind">
                  {{vpc_ips.vpc4Tips}}
                </div>
                <template #reference>
                  <van-field :disabled="vpc_ips.vpc6.value < 25" @blur="changeVpc4" :formatter="vpc2Formatter"
                    v-model="vpc_ips.vpc4" :step="1" format-trigger="onBlur" :controls="false" :min="0"
                    :max="255"></van-field>
                </template>
              </van-popover>
              <span class="ip-dot">/</span>
              <cur-select cur-class="custom-select" v-model:firpick="vpc_ips.vpc6.value" @change="changeVpcMask"
                :columns="vpc_ips.vpc6.select">
              </cur-select>
            </div>
          </div>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="addVpcClose">{{lang.subaccount_text32}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subAddVpc">{{ lang.subaccount_text31}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 加入安全组 -->
  <van-popup v-model:show="safeDialogShow" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.add_to_group}}</div>
      <div class="pop-body">
        <div class="safe-box">
          <span class="safe-lebal">{{lang.choose_group}}：</span>
          <cur-select cur-class="cur-select" v-model:firpick="safeID" :columns-names="{text: 'name', value: 'id'}"
            :columns="safeOptions">
          </cur-select>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="safeClose">{{lang.finance_text71}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subAddSafe">{{ lang.finance_text70}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 开启备份/快照弹窗 -->
  <van-popup v-model:show="isShowOpenBs" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text"> {{isBs? lang.common_cloud_btn62 : lang.common_cloud_btn63}}</div>
      <div class="pop-body">
        <cur-select v-if="isBs" :text="bsData.backNum + lang.common_cloud_text3" v-model:firpick="bsData.backNum"
          @change="bsSelectChange" cur-class="select-field select-div" :columns-names="{text: 'num', value: 'num'}"
          :columns="backup_config">
          <template #option="option">
            <span>{{option.num + lang.common_cloud_text3 + commonData.currency_prefix + option.price + '/' + bsData.duration}}</span>
          </template>
        </cur-select>
        <cur-select v-if="!isBs" :text="bsData.snapNum + lang.common_cloud_text4" v-model:firpick="bsData.snapNum"
          @change="bsSelectChange" cur-class="select-field select-div" :columns-names="{text: 'num', value: 'num'}"
          :columns="snap_config">
          <template #option="option">
            <span>{{option.num + lang.common_cloud_text4 + commonData.currency_prefix + option.price + '/' +  bsData.duration}}</span>
          </template>
        </cur-select>
      </div>
      <div class="pop-price">
        <div class="price-text">
          {{lang.common_cloud_text2}}{{isBs?bsData.backNum:bsData.snapNum}}{{lang.mf_one}}{{isBs?lang.common_cloud_title5:lang.common_cloud_btn54}}:
        </div>
        <div class="price-num" v-show="!bsDataLoading">
          {{commonData.currency_prefix}}{{(bsData.money * 1).toFixed(2)}}
          <van-popover placement="top">
            <div class="sure-remind">
              <div class="show-config-list">
                {{lang.common_cloud_text27}}：{{commonData.currency_prefix}}{{bsData.moneyDiscount }}
              </div>
              <div class="show-config-list">
                {{lang.common_cloud_text28}}：{{commonData.currency_prefix}}{{bsData.codePrice }}
              </div>
            </div>
            <template #reference>
              <van-icon name="info-o" class="help" v-if="isShowLevel || isShowPromo"></van-icon>
            </template>
          </van-popover>
        </div>
        <van-loading v-show="bsDataLoading"></van-loading>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="bsopenDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="bsopenSub">{{ lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 创建备份/快照弹窗 -->
  <van-popup v-model:show="isShwoCreateBs" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{isBs? lang.common_cloud_btn45 :lang.common_cloud_btn46}}</div>
      <div class="pop-body">
        <div class="s-tip">{{lang.common_cloud_btn47}}{{isBs? lang.common_cloud_btn45
          :lang.common_cloud_btn46}}{{lang.common_cloud_btn48}}</div>
        <div class="bsData-box">
          <cur-select :label="lang.common_cloud_tab3" v-model:firpick="createBsData.disk_id" :columns="allDiskList"
            :columns-names="{text: 'name', value: 'id'}" cur-class="select-field select-div" label-align="top">
          </cur-select>
          <van-field v-model="createBsData.name" :label="lang.invoice_text139" label-align="top" class="dia-field">
          </van-field>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="bsCgClose">{{lang.common_cloud_text181}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subCgBs" :loading="cgbsLoading">{{
          lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 还原备份、快照弹窗 -->
  <van-popup v-model:show="isShowhyBs" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_btn49}}</div>
      <div class="pop-body">
        <div class="hyBs-box">
          <span>
            {{lang.common_cloud_btn50}}
            <span class="name">{{restoreData.cloud_name}}</span>
            {{lang.common_cloud_btn51}}
          </span>
          <span>
            <span>{{restoreData.time}}</span>{{lang.common_cloud_btn52}}{{isBs?lang.common_cloud_btn53:lang.common_cloud_btn54}}</span>
          <span>{{lang.common_cloud_btn55}}{{isBs?lang.common_cloud_btn53:lang.common_cloud_btn54}}</span>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="bshyClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="subhyBs" :loading="loading3">{{
          lang.common_cloud_btn56}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 删除备份、快照弹窗 -->
  <van-popup v-model:show="isShowDelBs" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text danger-color">
        <van-icon name="warning-o"></van-icon>
        {{isBs?lang.common_cloud_btn57:lang.common_cloud_btn58}}
      </div>
      <div class="pop-body">
        <div class="tip-box">
          <span class="item-1">{{isBs?lang.common_cloud_btn57:lang.common_cloud_btn58}}: <span
              class="name">{{delData.name}}</span></span>
          <span class="item-2">{{lang.common_cloud_btn59}}{{delData.cloud_name}}{{lang.common_cloud_btn51}}
            <span>{{delData.time}}</span>
            {{lang.common_cloud_btn52}}{{isBs?lang.common_cloud_btn53:lang.common_cloud_btn54}}{{lang.common_cloud_btn60}}</span>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="delBsClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="danger" @click="subDelBs" :loading="loading4">{{
          lang.common_cloud_btn61}}</van-button>
      </div>
    </div>
  </van-popup>
  <!-- 自动续费确认弹窗 -->
  <van-popup v-model:show="isShowAutoRenew" round closeable style="width: 90%;">
    <div class="pop-box">
      <div class="dia-text">{{lang.common_cloud_text37}}{{isShowPayMsg? lang.common_cloud_text38 :
        lang.common_cloud_text39}}{{lang.auto_renew}}</div>
      <div class="pop-body">
        <div class="hyBs-box">
          <span>
            {{lang.fin_host}}
            <span class="name">{{hostData.name}}</span>
          </span>
        </div>
      </div>
      <div class="pop-fotter">
        <van-button class="can-btn" block @click="autoRenewDgClose">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="doAutoRenew">{{ lang.common_cloud_btn28}}</van-button>
      </div>
    </div>
  </van-popup>

  <!-- 镜像选择弹窗 -->
  <van-popup v-model:show="showImgPick" round position="bottom" teleport="body">
    <van-picker option-height=".96rem" visible-option-num="8" :columns="osSelectData"
      :columns-field-names="{ text: 'name', value: 'id' }" ref="selectPopRef">
      <template #toolbar>
        <div class="tool-bar">
          <img class="cancel-btn" @click="showImgPick = false"
            src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cancel.svg" alt="">
          <span class="tool-confirm" @click="handelSelectImg">{{lang.template_text135}}</span>
        </div>
      </template>
    </van-picker>
  </van-popup>
  <!-- 镜像选择弹窗 -->
  <van-action-sheet v-model:show="isShowImage" round>
    <div class="action-select">
      <div class="action-title">
        <div class="left-icon">
          <img class="cancel-btn" @click="isShowImage = false"
            src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/cancel.svg" alt="">
        </div>
        <div class="title-text">{{lang.cloud_menu_5}}</div>
        <div></div>
      </div>
      <div class="action-conctet image-action">
        <div class="image-action-item" v-for="item in osData" @click="changeImage(item)">
          <div class="select-name">
            <img
              :src="`/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/img/remf_finance/${item.icon}.svg`"
              alt="" class="image-icon" />
            <span>{{item.name}}</span>
          </div>
          <van-icon name="arrow"></van-icon>
        </div>
      </div>
    </div>
  </van-action-sheet>




  <!-- 安全验证 -->
  <safe-confirm ref="safeRef" v-model:password="client_operate_password" @confirm="hadelSafeConfirm"></safe-confirm>
  <!-- 图形验证码 -->
  <captcha-dialog :is-show-captcha="isShowCaptcha" ref="captcha"></captcha-dialog>
  <!-- 支付弹窗 -->
  <pay-dialog ref="topPayDialog" @payok="paySuccess" @paycancel="payCancel"></pay-dialog>
  <!-- 申请返现 -->
  <cash-back :id="id" :show-cash="isShowCashDialog" @cancledialog="cancleDialog" @showbtn="showBtn"></cash-back>
  <!-- 购买流量包 -->
  <flow-packet :id="id" :show-package="showPackage" @cancledialog="cancleDialog" v-if="showPackage"
    :currency_prefix="commonData.currency_prefix" @sendPackId="handlerPay">
  </flow-packet>

</div>



<!-- =======页面引入js和相关组件位置======= -->
<script src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/api/cloud.js"></script>
<script src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/lang/index.js"></script>
<script src="/plugins/reserver/mf_finance_dcim/template/clientarea/mobile/mfm201/js/cloudDetail.js"></script>
